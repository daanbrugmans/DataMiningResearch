attach(USArrests)
View(USArrests)
library(ggplot2)
ggplot(USarrests, aes(x=Murder, y=Assault)) + geom_point()
attach(USArrests)
data.frame <- USArrests
ggplot(USarrests, aes(x=Murder, y=Assault)) + geom_point()
ggplot(data.frame, aes(x=Murder, y=Assault)) + geom_point()
modus <- function(v){
tv <- table(v)
if(mode(v)=="character")
{return(names(tv[tv==max(tv)]))}
{return(as.numeric(names(tv[tv==max(tv)])))}
}
mean(data.frame$Murder)
median(data.frame$Murder)
modus(data.frame$Murder)
sd(data.frame$Murder)
library(dplyr)
murder_higher_than_average <- filter(data.frame, Murder > mean(data.frame$Murder))
hist(murder_higher_than_average, breaks=8)
hist(murder_higher_than_average$Murder, breaks=8)
View(murder_higher_than_average)
murder_higher_than_average <- filter(data.frame, Murder < mean(data.frame$Murder))
hist(murder_higher_than_average$Murder, breaks=8)
hist(data.frame$Murder)
murder_higher_than_average <- filter(data.frame, Murder < mean(data.frame$Murder))
hist(murder_higher_than_average$Murder, breaks=8)
View(murder_higher_than_average)
View(data.frame)
murder_higher_than_average <- filter(data.frame, Murder > mean(data.frame$Murder))
hist(murder_higher_than_average$Murder, breaks=8)
View(murder_higher_than_average)
murder_higher_than_average <- filter(data.frame, Murder > mean(data.frame$Murder))
hist(murder_higher_than_average$Murder, breaks=8)
mtext("Count of average amount of murders for states with a higher than national average", side=3, line=1.75)
hist(murder_higher_than_average$Murder, breaks=8, main="Count of average amount of murders for states with a higher than national average")
View(murder_higher_than_average)
below_average <- filter(data.frame, Murder > mean(data.frame$Murder))
above_average <- filter(data.frame, Murder < mean(data.frame$Murder))
View(below_average)
View(above_average)
below_average <- filter(data.frame, Murder < mean(data.frame$Murder))
above_average <- filter(data.frame, Murder > mean(data.frame$Murder))
View(above_average)
View(below_average)
wilcox.test(below_average$Murder, above_average$Murder, paired=F)
View(data.frame)
cor.test(data.frame$Murder, data.frame$Assault, method="pearson")
model <- lm(data.frame$Assault ~ data.frame$Murder)
summary(model)
model <- lm(data.frame$Murder ~ data.frame$Assault)
summary(model)
model <- lm(data.frame$Murder ~ data.frame$Assault)
summary(model)
kNN<-USArrests
kNN$VeelMoorden <- 0
kNN[kNN$Murder >= mean(kNN$Murder),]$VeelMoorden <- 1
library("class")
df<-kNN
set.seed(1)
n_train <- round(.6 * nrow(df))
data.train <- data.perm[1:ntrain,]
data.test <- data.perm[(ntrain+1):nrow(df),]
n_train <- round(.6 * nrow(df))
data.train <- df[1:ntrain,]
data.test <- df[(ntrain+1):nrow(df),]
n_train <- round(.6 * nrow(df))
data.train <- df[1:n_train,]
data.test <- df[(n_train+1):nrow(df),]
View(data.train)
model <- knn(train=data.train, test=data.test, k=2)
model <- knn(train=data.train, test=data.test, cl=kNN$VeelMoorden, k=2)
model <- knn(train=data.train, test=data.test, cl=kNN$Murder, k=2)
model <- knn(train=data.train, test=data.test, cl=data.train$Murder, k=2)
model <- knn(train=data.train, test=data.test, cl=data.train$VeelMoorden, k=2)
model <- knn(train=data.train, test=data.test, cl=data.train$VeelMoorden, k=2)
table(data.test$VeelMoorden, model)
data.frame <- USArrests
ggplot(data.frame, aes(x=Murder, y=Assault)) + geom_point()
mean(data.frame$Murder)
median(data.frame$Murder)
modus(data.frame$Murder)
modus(data.frame$Murder)
sd(data.frame$Murder)
hist(murder_higher_than_average$Murder, breaks=8, main="Count of average amount of murders for states with a higher than national average")
library(RODBC)
library(sqldf)
library(dplyr)
library(ggplot2)
con <- odbcConnect("SAS_ML")
numeric_data_analysis <- function(vector, vector.is_date=F) {
no_na <- vector[!is.na(vector)]
percentage_missing <- (sum(is.na(vector)) / length(vector)) * 100
return_list <- list(
"n" = length(vector),
"% Mis." = percentage_missing,
"Kard." = length(unique(vector)),
"Min." = min(no_na),
"1Q." = "Use summary() function",
"Gem." = mean(no_na),
"Med." = median(no_na),
"3Q." = "Use summary() function",
"Max." = max(no_na),
"Stddev." = sd(no_na)
)
if (vector.is_date == F) {
return_list["1Q."] <- quantile(no_na, 0.25)
return_list["3Q."] <- quantile(no_na, 0.75)
}
return(return_list)
}
categorical_data_analysis <- function(x, na.rm = TRUE) {
percentage_na <- (sum(is.na(x))/length(x))*100
if(na.rm){
x = x[!is.na(x)]
}
ux <- unique(x)
first_mode_index <- which.max(tabulate(match(x, ux)))
x2 <- x[x != ux[first_mode_index]]
second_mode_index <- which.max(tabulate(match(x2, ux)))
return(list("n" = length(x),
"% Mis." = percentage_na,
"Kard." = length(ux),
"Mod." = ux[first_mode_index],
"Mod. Freq." = sum(x == ux[first_mode_index]),
"Mod. %" = (sum(x == ux[first_mode_index])/length(x))*100,
"2de Mod." = ux[second_mode_index],
"2de Mod. Freq." = sum(x == ux[second_mode_index]),
"2de Mod. %" = (sum(x == ux[second_mode_index])/length(x))*100
))
}
library(ggplot2)
library(scales)
library(dplyr)
library(caret)
# Change working directory if needed, Josse.
setwd("C:/Users/Daan/Documents/Projecten/DataMiningResearch")
brfss.df <- read.csv("BRFSS2015.csv", header = T)
brfss.df <- read.csv("BRFSS2015Preprocessed.csv", header = T)
BMI.level.order <- c("Underweight", "Healthy weight", "Overweight", "Class 1 Obese", "Class 2 Obese", "Class 3 Obese")
Diabetes.level.order <- c("No diabetes", "Pre-diabetes", "Diabetes")
GenHlth.level.order <- c("Excellent", "Very good", "Good", "Fair", "Poor")
View(brfss.df)
brfss.df.relative <- brfss.df %>%
group_by(HighBP) %>%
mutate(HighBP=(HighBP / sum(HighBP))) %>%
ungroup() %>%
group_by(HighChol) %>%
mutate(HighChol=(HighChol / sum(HighChol))) %>%
ungroup() %>%
group_by(CholCheck) %>%
mutate(CholCheck=(CholCheck / sum(CholCheck))) %>%
ungroup() %>%
group_by(BMI) %>%
mutate(BMI=(BMI / sum(BMI))) %>%
ungroup() %>%
group_by(Smoker) %>%
mutate(Smoker=(Smoker / sum(Smoker))) %>%
ungroup() %>%
group_by(HighChol) %>%
mutate(HighChol=(HighChol / sum(HighChol))) %>%
ungroup() %>%
group_by(Stroke) %>%
mutate(Stroke=(Stroke / sum(Stroke))) %>%
ungroup() %>%
group_by(Diabetes) %>%
mutate(Diabetes=(Diabetes / sum(Diabetes))) %>%
ungroup() %>%
group_by(PhysActivity) %>%
mutate(PhysActivity=(PhysActivity / sum(PhysActivity))) %>%
ungroup() %>%
group_by(Fruits) %>%
mutate(Fruits=(Fruits / sum(Fruits))) %>%
ungroup() %>%
group_by(Veggies) %>%
mutate(Veggies=(Veggies / sum(Veggies))) %>%
ungroup() %>%
group_by(HvyAlcoholConsump) %>%
mutate(HvyAlcoholConsump=(HvyAlcoholConsump / sum(HvyAlcoholConsump))) %>%
ungroup() %>%
group_by(AnyHealthcare) %>%
mutate(AnyHealthcare=(AnyHealthcare / sum(AnyHealthcare))) %>%
ungroup() %>%
group_by(NoDocbcCost) %>%
mutate(NoDocbcCost=(NoDocbcCost / sum(NoDocbcCost))) %>%
ungroup() %>%
group_by(GenHlth) %>%
mutate(GenHlth=(GenHlth / sum(GenHlth))) %>%
ungroup() %>%
group_by(MentHlth) %>%
mutate(MentHlth=(MentHlth / sum(MentHlth))) %>%
ungroup() %>%
group_by(PhysHlth) %>%
mutate(PhysHlth=(PhysHlth / sum(PhysHlth))) %>%
ungroup() %>%
group_by(DiffWalk) %>%
mutate(DiffWalk=(DiffWalk / sum(DiffWalk))) %>%
ungroup() %>%
group_by(Sex) %>%
mutate(Sex=(Sex / sum(Sex))) %>%
ungroup() %>%
group_by(Age) %>%
mutate(Age=(Age / sum(Age))) %>%
ungroup() %>%
group_by(Education) %>%
mutate(Education=(Education / sum(Education))) %>%
ungroup() %>%
group_by(Income) %>%
mutate(Income=(Income / sum(Income))) %>%
ungroup() %>%
ggplot(brfss.df, aes(x=Income, fill=HeartDiseaseorAttack)) +
labs(title="Is your annual household income from all sources:", fill="Has had Heart Disease\nor Heart Attack") +
scale_fill_grey(start=.2, end=.7) +
coord_flip() +
geom_bar(position="dodge") +
geom_text(stat='count', aes(label=..count..), color="red", size=5, position=position_dodge(width=.9), vjust="bottom")
# Create data frame with relative data
brfss.df.relative <- brfss.df %>%
group_by(HighBP) %>%
mutate(HighBP=(HighBP / count(HighBP))) %>%
ungroup() %>%
group_by(HighChol) %>%
mutate(HighChol=(HighChol / count(HighChol))) %>%
ungroup() %>%
group_by(CholCheck) %>%
mutate(CholCheck=(CholCheck / count(CholCheck))) %>%
ungroup() %>%
group_by(BMI) %>%
mutate(BMI=(BMI / count(BMI))) %>%
ungroup() %>%
group_by(Smoker) %>%
mutate(Smoker=(Smoker / count(Smoker))) %>%
ungroup() %>%
group_by(HighChol) %>%
mutate(HighChol=(HighChol / count(HighChol))) %>%
ungroup() %>%
group_by(Stroke) %>%
mutate(Stroke=(Stroke / count(Stroke))) %>%
ungroup() %>%
group_by(Diabetes) %>%
mutate(Diabetes=(Diabetes / count(Diabetes))) %>%
ungroup() %>%
group_by(PhysActivity) %>%
mutate(PhysActivity=(PhysActivity / count(PhysActivity))) %>%
ungroup() %>%
group_by(Fruits) %>%
mutate(Fruits=(Fruits / count(Fruits))) %>%
ungroup() %>%
group_by(Veggies) %>%
mutate(Veggies=(Veggies / count(Veggies))) %>%
ungroup() %>%
group_by(HvyAlcoholConsump) %>%
mutate(HvyAlcoholConsump=(HvyAlcoholConsump / count(HvyAlcoholConsump))) %>%
ungroup() %>%
group_by(AnyHealthcare) %>%
mutate(AnyHealthcare=(AnyHealthcare / count(AnyHealthcare))) %>%
ungroup() %>%
group_by(NoDocbcCost) %>%
mutate(NoDocbcCost=(NoDocbcCost / count(NoDocbcCost))) %>%
ungroup() %>%
group_by(GenHlth) %>%
mutate(GenHlth=(GenHlth / count(GenHlth))) %>%
ungroup() %>%
group_by(MentHlth) %>%
mutate(MentHlth=(MentHlth / count(MentHlth))) %>%
ungroup() %>%
group_by(PhysHlth) %>%
mutate(PhysHlth=(PhysHlth / count(PhysHlth))) %>%
ungroup() %>%
group_by(DiffWalk) %>%
mutate(DiffWalk=(DiffWalk / count(DiffWalk))) %>%
ungroup() %>%
group_by(Sex) %>%
mutate(Sex=(Sex / count(Sex))) %>%
ungroup() %>%
group_by(Age) %>%
mutate(Age=(Age / count(Age))) %>%
ungroup() %>%
group_by(Education) %>%
mutate(Education=(Education / count(Education))) %>%
ungroup() %>%
group_by(Income) %>%
mutate(Income=(Income / count(Income))) %>%
ungroup()
group_by(Veggies) %>%
mutate(Veggies=(Veggies / count(Veggies))) %>%
ungroup() %>%
group_by(HvyAlcoholConsump) %>%
mutate(HvyAlcoholConsump=(HvyAlcoholConsump / count(HvyAlcoholConsump))) %>%
ungroup() %>%
group_by(AnyHealthcare) %>%
mutate(AnyHealthcare=(AnyHealthcare / count(AnyHealthcare))) %>%
ungroup() %>%
group_by(NoDocbcCost) %>%
mutate(NoDocbcCost=(NoDocbcCost / count(NoDocbcCost))) %>%
ungroup() %>%
group_by(GenHlth) %>%
mutate(GenHlth=(GenHlth / count(GenHlth))) %>%
ungroup() %>%
group_by(MentHlth) %>%
mutate(MentHlth=(MentHlth / count(MentHlth))) %>%
ungroup() %>%
group_by(PhysHlth) %>%
mutate(PhysHlth=(PhysHlth / count(PhysHlth))) %>%
ungroup() %>%
group_by(DiffWalk) %>%
mutate(DiffWalk=(DiffWalk / count(DiffWalk))) %>%
ungroup() %>%
group_by(Sex) %>%
mutate(Sex=(Sex / count(Sex))) %>%
ungroup() %>%
group_by(Age) %>%
mutate(Age=(Age / count(Age))) %>%
ungroup() %>%
group_by(Education) %>%
mutate(Education=(Education / count(Education))) %>%
ungroup() %>%
group_by(Income) %>%
mutate(Income=(Income / count(Income))) %>%
ungroup()
brfss.df.relative <- brfss.df
brfss.df.relative <- brfss.df.relative
group_by(HighBP) %>%
mutate(HighBP=(HighBP / count(HighBP))) %>%
ungroup()
brfss.df.relative <- brfss.df.relative %>%
group_by(HighChol) %>%
mutate(HighChol=(HighChol / count(HighChol))) %>%
ungroup()
brfss.df.relative <- brfss.df.relative %>%
group_by(CholCheck) %>%
mutate(CholCheck=(CholCheck / count(CholCheck))) %>%
ungroup()
brfss.df.relative <- brfss.df.relative %>%
group_by(BMI) %>%
mutate(BMI=(BMI / count(BMI))) %>%
ungroup()
brfss.df.relative <- brfss.df.relative %>%
group_by(Smoker) %>%
mutate(Smoker=(Smoker / count(Smoker))) %>%
ungroup()
brfss.df.relative <- brfss.df.relative %>%
group_by(HighChol) %>%
mutate(HighChol=(HighChol / count(HighChol))) %>%
ungroup()
brfss.df.relative <- brfss.df.relative %>%
group_by(Stroke) %>%
mutate(Stroke=(Stroke / count(Stroke))) %>%
ungroup()
brfss.df.relative <- brfss.df.relative %>%
group_by(Diabetes) %>%
mutate(Diabetes=(Diabetes / count(Diabetes))) %>%
ungroup()
brfss.df.relative <- brfss.df.relative %>%
group_by(PhysActivity) %>%
mutate(PhysActivity=(PhysActivity / count(PhysActivity))) %>%
ungroup()
brfss.df.relative <- brfss.df.relative %>%
group_by(Fruits) %>%
mutate(Fruits=(Fruits / count(Fruits))) %>%
ungroup()
brfss.df.relative <- brfss.df.relative %>%
group_by(Veggies) %>%
mutate(Veggies=(Veggies / count(Veggies))) %>%
ungroup()
brfss.df.relative <- brfss.df.relative %>%
group_by(HvyAlcoholConsump) %>%
mutate(HvyAlcoholConsump=(HvyAlcoholConsump / count(HvyAlcoholConsump))) %>%
ungroup()
brfss.df.relative <- brfss.df.relative %>%
group_by(AnyHealthcare) %>%
mutate(AnyHealthcare=(AnyHealthcare / count(AnyHealthcare))) %>%
ungroup()
brfss.df.relative <- brfss.df.relative %>%
group_by(NoDocbcCost) %>%
mutate(NoDocbcCost=(NoDocbcCost / count(NoDocbcCost))) %>%
ungroup()
brfss.df.relative <- brfss.df.relative %>%
group_by(GenHlth) %>%
mutate(GenHlth=(GenHlth / count(GenHlth))) %>%
ungroup()
brfss.df.relative <- brfss.df.relative %>%
group_by(MentHlth) %>%
mutate(MentHlth=(MentHlth / count(MentHlth))) %>%
ungroup()
brfss.df.relative <- brfss.df.relative %>%
group_by(PhysHlth) %>%
mutate(PhysHlth=(PhysHlth / count(PhysHlth))) %>%
ungroup()
brfss.df.relative <- brfss.df.relative %>%
group_by(DiffWalk) %>%
mutate(DiffWalk=(DiffWalk / count(DiffWalk))) %>%
ungroup()
brfss.df.relative <- brfss.df.relative %>%
group_by(Sex) %>%
mutate(Sex=(Sex / count(Sex))) %>%
ungroup()
brfss.df.relative <- brfss.df.relative %>%
group_by(Age) %>%
mutate(Age=(Age / count(Age))) %>%
ungroup()
brfss.df.relative <- brfss.df.relative %>%
group_by(Education) %>%
mutate(Education=(Education / count(Education))) %>%
ungroup()
brfss.df.relative <- brfss.df.relative %>%
group_by(Income) %>%
mutate(Income=(Income / count(Income))) %>%
ungroup()
brfss.df.relative <- brfss.df
brfss.df.relative <- brfss.df.relative
group_by(HighBP) %>%
mutate(HighBP=(HighBP / sum(HighBP))) %>%
ungroup()
brfss.df.relative <- brfss.df.relative %>%
group_by(HighChol) %>%
mutate(HighChol=(HighChol / sum(HighChol))) %>%
ungroup()
brfss.df.relative <- brfss.df.relative %>%
group_by(CholCheck) %>%
mutate(CholCheck=(CholCheck / sum(CholCheck))) %>%
ungroup()
brfss.df.relative <- brfss.df.relative %>%
group_by(BMI) %>%
mutate(BMI=(BMI / sum(BMI))) %>%
ungroup()
brfss.df.relative <- brfss.df.relative %>%
group_by(Smoker) %>%
mutate(Smoker=(Smoker / sum(Smoker))) %>%
ungroup()
brfss.df.relative <- brfss.df.relative %>%
group_by(HighChol) %>%
mutate(HighChol=(HighChol / sum(HighChol))) %>%
ungroup()
brfss.df.relative <- brfss.df.relative %>%
group_by(Stroke) %>%
mutate(Stroke=(Stroke / sum(Stroke))) %>%
ungroup()
brfss.df.relative <- brfss.df.relative %>%
group_by(Diabetes) %>%
mutate(Diabetes=(Diabetes / sum(Diabetes))) %>%
ungroup()
brfss.df.relative <- brfss.df.relative %>%
group_by(PhysActivity) %>%
mutate(PhysActivity=(PhysActivity / sum(PhysActivity))) %>%
ungroup()
brfss.df.relative <- brfss.df.relative %>%
group_by(Fruits) %>%
mutate(Fruits=(Fruits / sum(Fruits))) %>%
ungroup()
brfss.df.relative <- brfss.df.relative %>%
group_by(Veggies) %>%
mutate(Veggies=(Veggies / sum(Veggies))) %>%
ungroup()
brfss.df.relative <- brfss.df.relative %>%
group_by(HvyAlcoholConsump) %>%
mutate(HvyAlcoholConsump=(HvyAlcoholConsump / sum(HvyAlcoholConsump))) %>%
ungroup()
brfss.df.relative <- brfss.df.relative %>%
group_by(AnyHealthcare) %>%
mutate(AnyHealthcare=(AnyHealthcare / sum(AnyHealthcare))) %>%
ungroup()
brfss.df.relative <- brfss.df.relative %>%
group_by(NoDocbcCost) %>%
mutate(NoDocbcCost=(NoDocbcCost / sum(NoDocbcCost))) %>%
ungroup()
brfss.df.relative <- brfss.df.relative %>%
group_by(GenHlth) %>%
mutate(GenHlth=(GenHlth / sum(GenHlth))) %>%
ungroup()
brfss.df.relative <- brfss.df.relative %>%
group_by(MentHlth) %>%
mutate(MentHlth=(MentHlth / sum(MentHlth))) %>%
ungroup()
brfss.df.relative <- brfss.df.relative %>%
group_by(PhysHlth) %>%
mutate(PhysHlth=(PhysHlth / sum(PhysHlth))) %>%
ungroup()
brfss.df.relative <- brfss.df.relative %>%
group_by(DiffWalk) %>%
mutate(DiffWalk=(DiffWalk / sum(DiffWalk))) %>%
ungroup()
brfss.df.relative <- brfss.df.relative %>%
group_by(Sex) %>%
mutate(Sex=(Sex / sum(Sex))) %>%
ungroup()
brfss.df.relative <- brfss.df.relative %>%
group_by(Age) %>%
mutate(Age=(Age / sum(Age))) %>%
ungroup()
brfss.df.relative <- brfss.df.relative %>%
group_by(Education) %>%
mutate(Education=(Education / sum(Education))) %>%
ungroup()
brfss.df.relative <- brfss.df.relative %>%
group_by(Income) %>%
mutate(Income=(Income / sum(Income))) %>%
ungroup()
